// packages/types/src/vendors.ts
import { z } from "zod";
/**
 * Zod schema aligned 1:1 with db/schema/vendors.ts columns.
 * Booleans use Zod boolean with defaults mirroring Drizzle defaults.
 * Integer cents fields are numbers (integers).
 * Timestamps are epoch millis (number).
 */
export const vendorSchema = z.object({
    id: z.string(), // uuid-like string generated by DB default
    name: z.string(),
    businessName: z.string(),
    websiteUrl: z.string(),
    logoUrl: z.string().nullable().optional(),
    priceSelector: z.string().nullable().optional(),
    target: z.string().nullable().optional(),
    selector: z.string().nullable().optional(),
    priceAttr: z.string().nullable().optional(),
    priceRegex: z.string().nullable().optional(),
    searchUrl: z.string().nullable().optional(),
    currency: z.string().default("USD"),
    drawFeeCents: z.number().int().default(0),
    requisitionFeeCents: z.number().int().default(0),
    serviceFeeCents: z.number().int().default(0),
    doctorAppointmentOffered: z.boolean().default(false),
    supportEmail: z.string().nullable().optional(),
    supportPhone: z.string().nullable().optional(),
    notes: z.string().nullable().optional(),
    isActive: z.boolean().default(true),
    created_at: z.number().int().nonnegative().optional(),
    updated_at: z.number().int().nonnegative().optional(),
});
/**
 * Partial schema for PATCH/updates.
 * Keeps defaults for booleans/integers if you choose to apply defaults on merge.
 */
export const vendorPatchSchema = vendorSchema.partial();
/**
 * Insert schema:
 * - Typically omit `id`, `createdAt`, `updatedAt` so DB generates them.
 * - Keep same defaults for server-side fill.
 */
export const vendorInsertSchema = vendorSchema.omit({
    id: true,
    created_at: true,
    updated_at: true,
}).partial({
    // fields that have DB defaults can be optional at insert-time
    currency: true,
    drawFeeCents: true,
    requisitionFeeCents: true,
    serviceFeeCents: true,
    doctorAppointmentOffered: true,
    isActive: true,
});
